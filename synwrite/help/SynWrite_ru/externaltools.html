<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1251" />
<link rel="StyleSheet" href="style.css" type="text/css" media="screen" />
<title>Внешние инструменты</title>
</head>

<body><script language="javascript">
		if ((window.name != "content") && (navigator.userAgent.indexOf("Opera") <= -1) )
		document.write("<center><a href='index.html?page=ExternalTools.html'>show framing</a></center>")
		</script>

<h1>Внешние инструменты</h1>
<hr />

<ul>
  <li> <a href="#in">Введение</a></li>
  <li> <a href="#par">Макропеременные в параметрах</a></li>
  <li> <a href="#nav">Переходы к коду с ошибками</a></li>
  <li> <a href="#pre">Пресеты в "Строках вывода"</a></li>
  <li> <a href="#hlp">Вызов файлов справки </a><a href="externaltools.html#hlp">CHM/HLP</a></li>
  <li> <a href="#ww">Вызов сетевой справки</a></li>
  <li> <a href="#js">Вызов скриптов JS</a></li>
</ul>

<a name="in"></a>
<h2>Введение</h2>
<p>Диалог, который появляется по команде меню "Инструменты --
Настроить внешние инструменты", позволяет подключать к работе SynWrite другие
приложения:</p>
<ul>
  <li> Приложения с графическим интерфейсом (GUI).</li>
  <li> Консольные приложения, которые имееют только
	текстовое окно (подобное окну стандартной программы "cmd.exe"). Можно
	перенаправлять текстовый вывод от таких утилит в "Панель вывода". </li>
  <li> Пакетные BAT и CMD файлы, которые тоже
	отрабатывают как консольные приложения, и их вывод можно перехватить. </li>
  <li> Файлы справки в форматах CHM и HLP. Для поиска
	в такой справке будет использовано текущее слово (слово под кареткой редактора). </li>
  <li> Ссылки на интернет-страницы. Текущее слово может быть использовано для формирования адреса страницы.</li>
</ul>

<p>
Консольные приложения можно подключить к работе
несколькими способами: перехват их вывода в "Панель вывода",
перенаправление этого вывода в новый файл, замена выделения на
выданный текст и другие. Для указания подходящего способа включите
опцию "Захват вывода" и выберите из выпадющего списка "Тип вывода".
</p>
<p>
Все добавленные внешние инструменты доступны как элементы
главного меню "Инструменты" или, опционально, как элементы контекстного меню редактора.<br />
В текущей версии можно добавить не более 16 внешних инструментов.
</p>

<br />

<a name="par"></a>
<h2>Макропеременные в параметрах</h2>
<p>При настройке внешних инструментов в полях "Имя файла" и "Параметры"
можно использовать следующие макропеременные (почти полный их список появляется по
кнопке "Добавить", справа от поля "Параметры"):
</p>

<table style="border-collapse: collapse;" border="1" cellpadding="3">
<tbody>
	<tr>
		<td>
		  {FileName}<br />
		  {FileDir}<br />
		  {FileNameOnly}<br />
		  {FileNameNoExt}<br />
		  {FileExt}
		</td>
		<td>Свойства файла для текущей группы вкладок:
		  <ul>
		  <li> полный путь <br />
		  <li> только папка <br />
		  <li> только имя, без пути <br />
		  <li> только имя, без пути и расширения <br />
		  <li> только расширение
		  </ul>
		</td>
	</tr>
		<td>
		  {FileName2}<br />
		  {FileDir2}<br />
                  и т.д.
		</td>
		<td>Свойства файла для противоположной группы вкладок. <br />
                  (Если текущая группа - 1, то для группы 2; если текущая - 2, то для группы 1; иначе пустые строки.)
		</td>
	</tr>
	</tr>
		<td>
		  {FileNameN1} - {..N6} <br />
		  {FileDirN1} - {..N6} <br />
                  и т.д.
		</td>
		<td>Свойства файла для групп 1...6.
		</td>
	</tr>

	<tr>
		<td>
		  {ProjectDir}<br />
		  {ProjectWorkDir}<br />
		  {ProjectMainFileName}<br />
		  {ProjectMainFileDir}
		</td>
		<td>Свойства проекта:
		  <ul>
      <li>папка файла проекта (*.synw-proj)
		  <li>рабочая папка проекта
		  <li>главный файл проекта - полный путь
		  <li>главный файл проекта - папка
		  </ul>
		</td>
	</tr>

	<tr>
		<td>{CurrentWord}</td>
		<td>Слово, на которое указывает каретка (может быть пустым).</td>
	</tr>
	<tr>
		<td>{CurrentLine}</td>
		<td>Содержимое текущей строки (может быть пустым).</td>
	</tr>
	<tr>
		<td>{CurrentLineNum}</td>
		<td>Номер текущей строки (нумерация с 1).</td>
	</tr>
	<tr>
		<td>{CurrentColumnNum}</td>
		<td>Номер текущей колонки (нумерация с 1).</td>
	</tr>
	<tr>
		<td>{SelectedText}</td>
		<td>Текущий выделенный фрагмент текста (может быть пустым).</td>
	</tr>
	<tr>
		<td>{SelectedTextForWeb}</td>
		<td>Текущий выделенный фрагмент текста, адаптированный для интернет-адресов (может быть пустым).
            Напр., выделенный текст "some word info" даст значение "some+word+info".</td>
	</tr>
	<tr>
		<td>
		  {SelectionFileName} <br />
		  {SelectionFileNameNum}
		</td>
		<td>Полный путь к временному файлу, содержащему копию текущего
		выделенного фрагмента (Юникод-кодировка). 
		Второй вариант: нумерованное имя файла, чтобы не переписать старый файл.</td>
	</tr>
	<tr>
		<td>
		  {SelectionFileNameAnsi} <br />
		  {SelectionFileNameAnsiNum}
		</td>
		<td>Полный путь к временному файлу, содержащему копию
		текущего выделенного фрагмента (ANSI-кодировка).</td>
	</tr>

	<tr>
		<td>{ContentFileName}</td>
		<td>Полный путь к временному файлу, содержащему копию текста текущего редактора
		  (Юникод-кодировка).</td>
	</tr>
	<tr>
		<td>{ContentFileNameAnsi}</td>
		<td>Полный путь к временному файлу, содержащему копию текста текущего редактора
		(ANSI-кодировка).</td>
	</tr>

	<tr>
		<td>{Interactive}</td>
		<td>Текст, который введет пользователь по запросу перед вызовом
		внешнего инструмента.</td>
	</tr>
	<tr>
		<td>{InteractiveFile}</td>
		<td>Имя файла, который выберет пользователь по запросу перед
		вызовом внешнего инструмента.</td>
	</tr>
	<tr>
		<td>{InteractiveDir}</td>
		<td>Имя папки, которую выберет пользователь по запросу перед
		вызовом внешнего инструмента.</td>
	</tr>
	<tr>
		<td>{SynDir}</td>
		<td>Свойство SynWrite - папка, где установлена программа.</td>
	</tr>
	<tr>
		<td>{SynIniDir}</td>
		<td>Свойство SynWrite - папка, где хранятся файлы настроек ("Syn*.ini").</td>
	</tr>
	<tr>
		<td>{SynDrive}</td>
		<td>Свойство SynWrite - буква диска с символом двоеточия, для папки установки программы.</td>
	</tr>
  </tbody>
</table>

<a name="nav"></a>
<h2>Переходы к коду с ошибками</h2>

<p>Чтобы SynWrite мог выполнять переходы из "Панели вывода"
к местам, указанным в ошибках и предупреждениях, нужно настроить
шаблоны вывода. Включите опцию "Захват вывода", укажите в списке "Тип
вывода" вариант "Отобразить в панели вывода" и нажмите "Строки вывода".
Для  некоторых распространенных инструментов есть готовые
настройки, доступные по "Выбрать пресет...". Для нового инструмента
требуется ручная настройка. </p>

<h3>Пример</h3>

<p>Пусть есть файл "c:\test\ab.cpp" и нужно применить C++
Compiler "qcc.exe" как внешний инструмент. Диалог настройки может
выглядеть так:</p>

<p><img style="width: 708px; height: 367px;" alt="--" src="externaltools1.ru.png" /></p>

<p>Теперь при вызове этого инструмента выполнится такая команда:<br />

<span class="code">"C:\qcc\qcc.exe" "c:\test\ab.cpp"</span><br />

Текстовые сообщения от "qcc.exe" попадут не в консольное окно, а в
"панель вывода" внутри SynWrite. Появятся строки, типа таких:</p>
<pre class="code">c:\test\ab.cpp (10) Error: missing op1<br />c:\test\ab.cpp (11) Error: missing op2<br />c:\test\ab.cpp (12) Error: missing something<br /></pre>
<p>Видно, что компилятор нашел в исходном файла несколько
ошибок. Чтобы устранить очередную проблему, необходимо перейти к
указанному месту в исходном файле. SynWrite сделает это автоматически,
но сначала нужно продолжить настройки и указать, как извлечь из
сообщений имена файлов и номера строк/колонок. Эта настройка
выполняется в диалоге "Строки вывода". Регулярное выражение позволяет
распознать нужные части. Например, оно может быть таким:
</p>
<pre><span class="code">.+ \(\d+\) .*</span>
</pre>

<p>Осталось заключить найденные части в круглые скобки,
чтобы на них можно ссылаться, как на подвыражения. Первая часть: ".+" -
это имя файла, вторая часть "\d+" - это номер строки. Получится так:
</p>
<pre><span class="code">(.+) \((\d+)\) .*</span>
</pre>

<p>
Теперь для "Имя файла" указываем "1" (то есть первое
подвыражение), для "Строка" указываем "2" (второе), для "Колонка"
оставляем "--".&nbsp;
</p>

<p><img style="width: 327px; height: 297px;" alt="--" src="externaltools2.ru.png" /></p>

<p>Если вы указали все поля, можете протестировать их:
введите строку для проверки и нажмите "Проверить".
</p>
<p>Замечание. В некоторых случаях "Имя файла" нужно
оставить в виде "--". Это может понадобиться, если в выводе нет указания
на файлы, а исходный файл общий для всех сообщений этого приложения.
</p>
<br />

<a name="pre"></a>
<h2>Пресеты в "Строках вывода"</h2>

<p>После самостоятельной настройки "Строк вывода", вы можете сохранить
эти настройки в файл (например, чтобы поделиться ими). Есть две кнопки
"Выбрать пресет..." и "Сохранить пресет...", последняя позволяет
сохранить ваши настройки. В процессе сохранения нужно будет указать имя
и файл (без пути) для нового пресета. В конце появится сообщение с
полным именем файла, хранящего новый пресет. </p>
<br />

<a name="hlp"></a>
<h2>Вызов файлов справки CHM/HLP</h2>

<p>Через внешние инструменты можно выполнять быстрый доступ к CHM и HLP
файлам. SynWrite откроет эти файлы и выполнит в них поиск текущего
слова или выделенного фрагмента. Это удобно, если в работе применяются
руководства типа "php_manual_en.chm" (для PHP). Достаточно указать
слово, например, "array", и вызвать этот файл справки.</p>

<p>Во-первых, создайте новый внешний инструмент, указав нужный файл
справки в поле "Имя файла".<br />

<br />

<img style="width: 708px; height: 367px;" alt="--" src="externaltools3.ru.png" /></p>

<br />
<p>Теперь в тексте выделите или укажите кареткой слово "array", затем
вызовите команду меню "Инструменты -- PHP Manual". Откроется справка на
странице с информацией о "array".<br />

<br />

<img src="externaltools4.png" /></p>
<br />

<a name="ww"></a>
<h2>Вызов сетевой справки</h2>

<p>Можно вызывать браузер с заданным адресом интернет-страницы. Например, вот так
можно вызвать официальную справку по тегам HTML:
</p>

<ul>
  <li> <b>Название: </b>Tag Help<b></b></li>
  <li> <b>Имя файла: </b>одно из имен "iexplore.exe", "firefox.exe", "chrome.exe", "opera.exe"
  	(без кавычек)<b></b></li>
  <li> <b>Параметры: </b>http://www.w3schools.com/tags/tag_<font color="blue">{CurrentWord}</font>.asp<b></b></li>
</ul>
<p>Теперь кареткой укажите на тег HTML и вызовите команду "Инструменты -- Tag Help".
</p>
<br />

<a name="js"></a>
<h2>Вызов скриптов JS</h2>

<p>Можно запускать скрипты JavaScript (JS), используя стандартую
функциональность <a href="http://en.wikipedia.org/wiki/windows_script_host" target="_blank">WSH</a>.
Вот как могут выглядеть настройки, если JS-скрипту нужно передать имя файла:
</p>

<ul>
  <li> <b>Имя:</b> My Script<b></b></li>
  <li> <b>Имя файла:</b> cscript.exe<b></b></li>
  <li> <b>Параметры: </b>"C:\MyScript\MyScript.js" "{FileName}"<b></b></li>
  <li> <b>Захват вывода: </b>включен<b></b></li>
  <li> <b>Тип вывода: </b>Отобразить в панели вывода<b></b></li>
  <li> <b>Кодировка</b><b>:</b> OEM (DOS)<b></b></li>
</ul>

<br />

</body>
</html>