<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1251" />
<link rel="StyleSheet" href="style.css" type="text/css" media="screen" />
<title>Фрагменты (сниппеты)</title>
</head>
<body><script language="javascript">
		if ((window.name != "content") && (navigator.userAgent.indexOf("Opera") <= -1) )
		document.write("<center><a href='index.html?page=Snippets.html'>show framing</a></center>")
		</script>

<h1>Фрагменты (сниппеты)</h1>
<hr />

<ul>
  <li><a href="#in">Введение</a></li>
  <li><a href="#tabstops">Табстопы</a></li>
  <li><a href="#mirror">Зеркальные табстопы</a></li>
  <li><a href="#mode">Режим табстопов</a></li>
  <li><a href="#macros">Макросы</a></li>
  <li><a href="#files">Файлы фрагментов</a></li>
  <li><a href="#dist">Как создать дистрибутив с фрагментами</a></li>
</ul>

<a name="in"></a>
<h2>Введение</h2>

<p>
Фрагменты или сниппеты — это короткие фрагменты текста, которые могут быть привязаны к лексеру. (Аналогичная возможность «Шаблоны кода» уже удалена). Чтобы вставить текст фрагмента, активируйте нужный лексер (фрагменты уже есть для C, C++, Pascal, Java и др.) и вызовите диалог «Инструменты – Фрагменты», где выберите нужный пункт из списка и нажмите Enter.
</p>
<p>
Чтобы создать новый фрагмент, есть диалог «Инструменты – Новый фрагмент», который предлагает ввести все нужные поля (название, псевдоним, список лексеров и текст) и сохранить файл фрагмента в нужной папке.
</p>
<p>
Если у фрагмента есть псевдоним, то можно просто набрать его в редакторе и нажать Табуляцию — фрагмент сразу вставится. Набирать псевдоним надо полностью. Разные фрагменты могут иметь одинаковое название и даже одинаковый псевдоним (при раскрытии по Таб будет показан диалог с уточнением).
</p>
<p>
Если в тексте фрагмента есть символы табуляции, то они будут заменены при вставке на пробелы, если таковы настройки редактора (берется или глобальная настройка, или переопределение для текущего лексера, если оно задано).
</p>
<br />

<a name="tabstops"></a>
<h2>Табстопы</h2>
<p>
В тексте фрагмента допустимы указания «табстопов» - позиций, на которые будут ставиться временные маркеры, и по которым можно «прыгать» после вставки фрагмента нажатием Табуляции. Допустимо максимум 10 табстопов, которые указываются так:
</p>
<p>
<span class="inlinecode">${1}</span> <br />
... <br />
<span class="inlinecode">${9}</span> <br />
<span class="inlinecode">${0}</span> <br />
</p>

<p>
Они активируются в таком порядке: сначала ${1}, потом ${2} … и в конце ${0}.
</p>
<p>
Можно указывать табстопы с текстом по умолчанию, например:
<pre class="code">${1:text here}</pre>
</p>
<p>
Можно указывать табстопы с пропусками, например:
<pre class="code">${1:text} text ${3:text} text ${0:end text}</pre>
</p>
<br />

<a name="mirror"></a>
<h2>Зеркальные табстопы</h2>
<p>
Можно указывать «зеркальные» табстопы, т.е. несколько раз указать один и тот же номер, например:
<pre class="code">
start ${1}, carets here: ${2} and here: ${2} and here: ${2}, ended at ${0}.
</pre>
В этом примере табстоп 2 имеет «зеркала», при активации первого вхождения этого табстопа будут расставлены мульти-каретки в двух дополнительных позициях, и текст можно будет набирать сразу в трех позициях. 
</p>
<br />

<a name="mode"></a>
<h2>Режим табстопов</h2>
<p>
Если в тексте фрагмента есть табстопы, и их больше одного, то при вставке фрагмента активируется специальный режим — в нем клавиша Табуляции работает не как обычно, а перемещает нас к следующему табстопу (и выделяет текст по умолчанию в этом табстопе). Режим выключается сам, после перехода к последнему табстопу. Можно видеть, когда режим активен, по наличию красных треугольников-маркеров в позициях табстопов (когда маркеров больше нет, режим выключился). 
</p>
<p>
Можно и отвлечься от заполнения табстопов (например, перейти вручную в любую позицию текста), но при этом Табуляция не будет работать как обычно, а будет возвращать к оставшимся табстопам.
</p>
<p>
Можно и вручную выключить этот режим, удалив все маркеры — команда «Закладки – Маркеры – Удалить маркеры», или просто снимая маркеры по-одному: «Закладки – Маркеры – Снять маркер» (хотя это неудобно).
</p>
<br />

<a name="macros"></a>
<h2>Макросы</h2>
<p>
В тексте фрагмента допустимы такие макросы:
</p>
<ul>
    <li> <span class="inlinecode">${sel}</span> – Заменяется на текст, выделенный до вставки фрагмента. 
                                  (При вызове по Таб - пустое значение.)
    <li> <span class="inlinecode">${cp}</span> – Заменяется на текст из буфера обмена.
    <li> <span class="inlinecode">${date:nnnn}</span> – Заменяется на текущую дату/время, используя <a href="miscdateformat.html">строку-модификатор</a> "nnnn".
    <li> <span class="inlinecode">${fname}</span> – Заменяется на имя текущего файла (без пути и расширения).
</ul>

<p>
Примечание: если вам нужно указать в тексте строку вида 
<span class="inlinecode">${...}</span>
, то экранируйте символ доллара: 
<span class="inlinecode">\${...}</span>
.
</p>
<br />

<a name="files"></a>
<h2>Файлы фрагментов</h2>

<p>
Фрагменты хранятся в отдельных файлах. Это текстовые файлы с расширением ”synw-snippet”, в кодировке UTF8-без-BOM. Они ищутся в подпапке ”Data\snippets” и всех ее подпапках. Имена файлов и подпапок неважны, но рекомендуется называть новые подпапки как ”AuthorName.LangName”, чтобы после установки ваших фрагментов другими пользователями можно было легко найти новые папки и удалить их.
</p>

<h4>Пример файла</h4>
<pre class="code">
name=do-while loop
id=do
lex=C,C++
text=
do
{
	${0:/* code */}
} while (${1:/* condition */});
</pre>

<h4>Формат файла</h4>

<p>
Первые строки имеют вид ”имя=значение” (пробелы вокруг знака «=» недопустимы), где «имя» - одна из строк:
</p>
<ul>
    <li>name – задает название (любая строка).
    <li>id — задает псевдоним (состоит из латинских букв, цифр и точек) (можно пропустить всю строку).
    <li>lex — задает список лексеров, через запятую, в которых фрагмент активен (можно пропустить всю строку, тогда фрагмент будет всегда активен).
</ul>
<p>
После идет строка ”text=” без значения, и все строки после нее - это текст фрагмента. Последние пустые строки в файле отбрасываются.
</p>
<br />

<a name="dist"></a>
<h2>Как создать дистрибутив с фрагментами</h2>

<p>
Вы можете создать ZIP или RAR архив со своими фрагментами - пользователь откроет архив в SynWrite и 
получит предложение установить его. Для этого запакуйте в корень архива:
</p>

<ul>
    <li> Папку "AuthorName.LexerName" с вашими фрагментами, т.е. файлами "synw-snippet". (Папка будет установлена внутрь папки "Data\snippets".)
    <li> Текстовый файл "install.inf" со следующим содержанием.
</ul>

<h4>Пример файла install.inf</h4>
<pre class="code">
[info]
title=LexerName snippets
type=template
subdir=snippets
</pre>
<br />

</body>
</html>